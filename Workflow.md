# Как работать над проектом

## Окружение

Для удобства работы над проектом используются инструменты из **Node.js** и **npm**. Все необходимые настройки произведены. Убедитесь, что на рабочем компьютере установлен актуальный LTS релиз Node.js**. Актуальная версия **Node.js** указана в файле `package.json` в поле `node`. Затем, в терминале, перейдите в директорию с проектом и _единожды_ запустите команду:

```bash
npm install
```

Команда запустит процесс установки зависимостей проекта из **npm**.

### Переменные окружения

Пример заполнения приведен в файле [.env.example]

| Параметр             | Значение     | Комментарий                                              |
| -------------------- | ------------ | -------------------------------------------------------- |
| **HOST**             | _localhost_  | хост                                                     |
| **PORT**             | _5000_       | порт сервера                                             |
| **SALT**             | _secret_     | случайная строка (соль)                                  |
| **DB_USER**          | _admin_      | логин базы данных                                        |
| **DB_PASSWORD**      | _password_   | пароль базы данных                                       |
| **DB_PORT**          | _27017_      | порт базы данных                                         |
| **DB_NAME**          | _six-cities_ | название базы данных                                     |
| **DB_HOST**          | _127.0.0.1_  | хост                                                     |
| **UPLOAD_DIRECTORY** | _upload_     | директория для загрузки аватарок                         |
| **STATIC_DIRECTORY** | _static_     | директория для файлов по умолчанию (аватар по умолчанию) |
| **JWT_SECRET**       | _jwt-key_    | ключ для JWT                                             |

### Сценарии

В `package.json` предопределено несколько сценариев.

#### Скомпилировать проект

```bash
npm run compile
```

Создаст директорию `dist` и скомпилирует проект.

#### Удалить скомпилированный проект

```bash
npm run clean
```

Удаляет директорию `dist`. Используется перед компиляцией.

#### Собрать проект

```bash
npm run build
```

Выполняет сборку проекта: удаляет ранее скомпилированный проект и компилирует заново.

#### Проверить линтером

```bash
npm run lint
```

Запуск проверки проекта статическим анализатором кода **ESLint**.

Линтер проверяет файлы только внутри директории `src`.

**Обратите внимание**, при запуске данной команды, ошибки выводятся в терминал.

#### Запустить ts-модуль без компиляции

```bash
npm run ts -- <Путь к модулю с ts-кодом>
```

Пакет `ts-node` позволяет выполнить TS-код в Node.js без предварительной компиляции. Используется только на этапе разработки.

#### Запустить моковый сервер

```bash
npm run mock:server
```

#### Запустить проект

```bash
npm start
```

В процессе запуска проекта будет выполнен процесс «Сборки проекта» и запуска результирующего кода.

**Запуск в режиме разработки**

```bash
npm start:dev
```

# Запуск проекта

1. Установить пакеты
   `npm i`
2. Запустить моковый сервер
   `npm run mock:server`
3. Сгенерировать тестовые данные

```sh
npm run ts ./src/main.cli.ts -- --generate 10 ./mocks/new-offers.tsv http://localhost:3123/api
```

4. Запустить докер `docker compose -p "six-cities" up -d`
5. Заполнить базу данных сгенерированными значениями

```sh
npm run ts ./src/main.cli.ts -- --import ./mocks/new-offers.tsv admin password localhost six-cities secret
```

6. Запустить сервер `npm run start`
7. Инструкция по запуску фронтенда - [Readme.md](frontend/project/Readme.md)

## Структура проекта

### Директория `src`

Исходный код проекта: компоненты, модули и так далее. Структура директории `src` может быть произвольной.

### Директория `static`
Статичные ресурсы
### Директория `upload`
Директория для загрузки аватарок пользователей
### Директория `frontend`
Исходный код фронэнда

### Файл `Readme.md`

Инструкции по работе с учебным репозиторием.

### Файл `Contributing.md`

Советы и инструкции по внесению изменений в учебный репозиторий.

### Остальное

Все остальные файлы в проекте являются служебными. Пожалуйста, не удаляйте и не изменяйте их самовольно. Только если того требует задание или наставник.

